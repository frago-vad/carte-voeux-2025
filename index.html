<!doctype html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>VÅ“ux</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>

  <body>
    <div class="wrap">
      <div class="player" id="player">
        <video id="video" class="video" playsinline preload="metadata">
          <source src="./voeux.mp4" type="video/mp4" />
          Votre navigateur ne supporte pas la vidÃ©o.
        </video>

        <!-- Zone de tap invisible -->
        <button
          id="tapZone"
          class="tap-zone"
          type="button"
          aria-label="Lecture / Pause"
        ></button>

        <!-- ContrÃ´les -->
        <div id="controls" class="controls">
          <button id="togglePlay" class="control-btn" aria-label="Lecture / Pause">
            â–¶
          </button>

          <button id="toggleMute" class="control-btn" aria-label="Mute / Unmute">
            ðŸ”Š
          </button>

          <!-- Plein Ã©cran (mobile paysage uniquement via CSS) -->
          <button
            id="toggleFullscreen"
            class="control-btn fullscreen-btn"
            aria-label="Plein Ã©cran"
          >
            â›¶
          </button>
        </div>

        <!-- Hint mobile portrait uniquement -->
        <div class="rotate-hint" aria-hidden="true"></div>
      </div>
    </div>

    <script>
      const video = document.getElementById("video");
      const player = document.getElementById("player");
      const playBtn = document.getElementById("togglePlay");
      const muteBtn = document.getElementById("toggleMute");
      const fsBtn = document.getElementById("toggleFullscreen");
      const tapZone = document.getElementById("tapZone");
      const controls = document.getElementById("controls");

      let hideTimer = null;

      function updatePlayIcon() {
        playBtn.textContent = video.paused ? "â–¶" : "âšâš";
      }

      function updateMuteIcon() {
        muteBtn.textContent = video.muted ? "ðŸ”‡" : "ðŸ”Š";
      }

      function fadeControlsAfterUse() {
        controls.classList.remove("controls-hidden");
        clearTimeout(hideTimer);
        hideTimer = setTimeout(() => {
          controls.classList.add("controls-hidden");
        }, 2000);
      }

      function togglePlay() {
        video.paused ? video.play() : video.pause();
        updatePlayIcon();
        fadeControlsAfterUse();
      }

      playBtn.addEventListener("click", togglePlay);
      tapZone.addEventListener("click", togglePlay);

      muteBtn.addEventListener("click", () => {
        video.muted = !video.muted;
        updateMuteIcon();
        fadeControlsAfterUse();
      });

      // ----- Plein Ã©cran -----
      fsBtn.addEventListener("click", async () => {
        try {
          if (!document.fullscreenElement) {
            await player.requestFullscreen();
          } else {
            await document.exitFullscreen();
          }
          fadeControlsAfterUse();
        } catch (e) {
          console.log("Fullscreen non supportÃ©", e);
        }
      });

      // Sortie du plein Ã©cran â†’ contrÃ´les visibles
      document.addEventListener("fullscreenchange", () => {
        controls.classList.remove("controls-hidden");
        clearTimeout(hideTimer);
      });

      // Pause = contrÃ´les visibles
      video.addEventListener("pause", () => {
        controls.classList.remove("controls-hidden");
        clearTimeout(hideTimer);
      });

      // Fin de vidÃ©o = contrÃ´les visibles
      video.addEventListener("ended", () => {
        controls.classList.remove("controls-hidden");
        updatePlayIcon();
        clearTimeout(hideTimer);
      });

      video.addEventListener("play", updatePlayIcon);

      updatePlayIcon();
      updateMuteIcon();
    </script>
  </body>
</html>

