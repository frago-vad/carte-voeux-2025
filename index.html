<!doctype html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>VÅ“ux</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>

  <body>
    <div class="wrap">
      <div class="player">
        <video id="video" class="video" playsinline preload="metadata">
          <source src="./voeux.mp4" type="video/mp4" />
          Votre navigateur ne supporte pas la vidÃ©o.
        </video>

        <!-- Zone de tap invisible (uniquement sur la zone vidÃ©o) -->
        <button
          id="tapZone"
          class="tap-zone"
          type="button"
          aria-label="Lecture / Pause"
        ></button>

        <!-- ContrÃ´les (sous la vidÃ©o) -->
        <div id="controls" class="controls">
          <button id="togglePlay" class="control-btn" aria-label="Lecture / Pause">
            â–¶
          </button>

          <button id="toggleMute" class="control-btn" aria-label="Mute / Unmute">
            ðŸ”Š
          </button>
        </div>

        <!-- Hint (mobile portrait uniquement via CSS) -->
        <div class="rotate-hint" aria-hidden="true">Tournez votre tÃ©lÃ©phone</div>
      </div>
    </div>

    <script>
      const video = document.getElementById("video");
      const playBtn = document.getElementById("togglePlay");
      const muteBtn = document.getElementById("toggleMute");
      const tapZone = document.getElementById("tapZone");
      const controls = document.getElementById("controls");

      let hideTimer = null;

      function updatePlayIcon() {
        playBtn.textContent = video.paused ? "â–¶" : "âšâš";
      }

      function updateMuteIcon() {
        muteBtn.textContent = video.muted ? "ðŸ”‡" : "ðŸ”Š";
      }

      // Fade aprÃ¨s 2s UNIQUEMENT suite Ã  une action sur un bouton
      function fadeControlsAfterUse() {
        controls.classList.remove("controls-hidden");
        clearTimeout(hideTimer);
        hideTimer = setTimeout(() => {
          controls.classList.add("controls-hidden");
        }, 2000);
      }

      function togglePlay() {
        video.paused ? video.play() : video.pause();
        updatePlayIcon();
        fadeControlsAfterUse();
      }

      playBtn.addEventListener("click", togglePlay);

      muteBtn.addEventListener("click", () => {
        video.muted = !video.muted;
        updateMuteIcon();
        fadeControlsAfterUse();
      });

      // Tap sur la vidÃ©o = play/pause (et lance le fade)
      tapZone.addEventListener("click", togglePlay);

      // Si la vidÃ©o est en pause, on garde les boutons visibles
      video.addEventListener("pause", () => {
        controls.classList.remove("controls-hidden");
        clearTimeout(hideTimer);
      });

      // Fin de vidÃ©o : boutons visibles, rester sur la derniÃ¨re image
      video.addEventListener("ended", () => {
        controls.classList.remove("controls-hidden");
        updatePlayIcon();
        clearTimeout(hideTimer);
      });

      video.addEventListener("play", updatePlayIcon);

      updatePlayIcon();
      updateMuteIcon();
      // On ne lance pas de fade au chargement
    </script>
  </body>
</html>
