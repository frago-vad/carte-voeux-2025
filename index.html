<!doctype html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>VÅ“ux</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>

  <body>
    <div class="wrap">
      <div class="player">
        <video id="video" class="video" playsinline preload="metadata">
          <source src="./voeux.mp4" type="video/mp4" />
          Votre navigateur ne supporte pas la vidÃ©o.
        </video>

        <!-- Zone de tap invisible -->
        <button
          id="tapZone"
          class="tap-zone"
          type="button"
          aria-label="Lecture / Pause"
        ></button>

        <!-- ContrÃ´les -->
        <div id="controls" class="controls">
          <button id="togglePlay" class="control-btn" aria-label="Lecture / Pause">
            â–¶
          </button>

          <button id="toggleMute" class="control-btn" aria-label="Mute / Unmute">
            ðŸ”Š
          </button>
        </div>

        <div class="rotate-hint" aria-hidden="true">
          Tournez votre tÃ©lÃ©phone
        </div>
      </div>
    </div>

    <script>
      const video = document.getElementById("video");
      const playBtn = document.getElementById("togglePlay");
      const muteBtn = document.getElementById("toggleMute");
      const tapZone = document.getElementById("tapZone");
      const controls = document.getElementById("controls");

      const isMobile = window.matchMedia("(max-width: 900px)").matches;
      let hideTimer = null;

      function updatePlayIcon() {
        playBtn.textContent = video.paused ? "â–¶" : "âšâš";
      }

      function updateMuteIcon() {
        muteBtn.textContent = video.muted ? "ðŸ”‡" : "ðŸ”Š";
      }

      function togglePlay() {
        video.paused ? video.play() : video.pause();
        updatePlayIcon();
        showControls();
      }

      function showControls() {
        controls.classList.remove("controls-hidden");
        clearTimeout(hideTimer);

        // Fade aprÃ¨s 2s UNIQUEMENT quand la vidÃ©o joue
        if (!video.paused) {
          hideTimer = setTimeout(() => {
            controls.classList.add("controls-hidden");
          }, 2000);
        }
      }

      playBtn.addEventListener("click", togglePlay);

      muteBtn.addEventListener("click", () => {
        video.muted = !video.muted;
        updateMuteIcon();
        showControls();
      });

      tapZone.addEventListener("click", togglePlay);

      // Desktop : mouvement souris = rÃ©afficher
      document.addEventListener("mousemove", () => {
        if (!isMobile) showControls();
      });

      // Mobile : touch = rÃ©afficher
      document.addEventListener("touchstart", () => {
        if (isMobile) showControls();
      }, { passive: true });

      video.addEventListener("play", showControls);

      video.addEventListener("pause", () => {
        controls.classList.remove("controls-hidden");
        clearTimeout(hideTimer);
      });

      // ðŸ”‘ FIN DE VIDÃ‰O : boutons visibles
      video.addEventListener("ended", () => {
        controls.classList.remove("controls-hidden");
        updatePlayIcon();
        clearTimeout(hideTimer);
      });

      updatePlayIcon();
      updateMuteIcon();
      showControls();
    </script>
  </body>
</html>
